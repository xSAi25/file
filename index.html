<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>For Sam ‚ù§Ô∏è</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&display=swap" rel="stylesheet">
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #fff0f3;
            font-family: 'Fredoka', sans-serif;
            overflow: hidden;
            position: relative;
        }

        /* --- MOVING BANNER --- */
        .banner-wrapper {
            position: fixed;
            top: 0; left: 0; width: 100%;
            background: #d00000; color: white;
            overflow: hidden; padding: 10px 0; z-index: 100;
        }

        .banner-text {
            display: inline-block;
            white-space: nowrap;
            font-size: 1.2rem;
            font-weight: 600;
            animation: scroll-banner 20s linear infinite;
        }

        @keyframes scroll-banner {
            0% { transform: translateX(100%); }
            100% { transform: translateX(-100%); }
        }

        .rain-container {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            pointer-events: none; z-index: 1;
        }

        .drop {
            position: absolute; top: -50px; font-size: 1.5rem;
            animation: fall linear infinite;
        }

        @keyframes fall {
            to { transform: translateY(110vh) rotate(360deg); }
        }

        .container {
            text-align: center;
            background: rgba(255, 255, 255, 0.98);
            padding: 35px;
            border-radius: 30px;
            box-shadow: 0 10px 40px rgba(208, 0, 0, 0.15);
            max-width: 420px;
            width: 90%;
            position: relative;
            z-index: 10;
            border: 3px solid #ffccd5;
        }

        input {
            width: 85%;
            padding: 15px;
            margin-bottom: 25px;
            border: 3px solid #ffccd5;
            border-radius: 20px;
            text-align: center;
            font-size: 1.3rem;
            font-family: 'Fredoka', sans-serif;
            color: #d00000;
            background-color: #fffafb;
            outline: none;
            transition: 0.3s;
            box-sizing: border-box;
        }

        input:focus {
            border-color: #ff4d6d;
            box-shadow: 0 0 15px rgba(255, 77, 109, 0.3);
            background-color: #ffffff;
        }

        #curvedTextContainer {
            width: 100%;
            height: 160px;
            margin-bottom: -15px;
            display: flex;
            justify-content: center;
            align-items: flex-end;
        }

        .curved-text-svg {
            width: 100%;
            height: 100%;
            fill: #ffffff;
            font-family: 'Fredoka', sans-serif;
            font-weight: 600;
            font-size: 20px; 
            text-transform: uppercase;
            filter: drop-shadow(0 0 6px #ff0000) drop-shadow(0 0 10px #d00000);
        }

        .heart-btn-wrapper {
            position: relative;
            display: inline-block;
            cursor: pointer;
            transition: 0.3s;
        }

        .heart-icon {
            font-size: 8rem;
            color: #d00000;
            animation: pulse 1.5s infinite;
        }

        .heart-overlay-text {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 70%; color: white;
            font-size: 0.75rem; font-weight: bold;
            line-height: 1.1; pointer-events: none;
            text-transform: uppercase;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .buttons { display: flex; gap: 15px; margin-top: 25px; }

        button {
            cursor: pointer; transition: 0.3s; border: none;
            font-family: 'Fredoka', sans-serif; font-weight: 600; border-radius: 50px;
        }

        .primary-btn { background-color: #d00000; color: white; width: 100%; padding: 15px; font-size: 1.1rem; }
        #noBtn { background-color: #e9ecef; color: #495057; width: 100%; padding: 15px; }

        .hidden { display: none; }

        .heart-particle {
            position: absolute; pointer-events: none; font-size: 2rem;
            z-index: 100; animation: burstMove 2s ease-out forwards;
        }

        @keyframes burstMove {
            0% { transform: translate(-50%, -50%) scale(0); opacity: 1; }
            100% { transform: translate(calc(-50% + var(--x)), calc(-50% + var(--y))) scale(1.2); opacity: 0; }
        }
    </style>
</head>
<body>

<div class="banner-wrapper">
    <div class="banner-text">
        üíû Every heartbeat of mine whispers your name üíû Happy Valentine‚Äôs Day Sam üíû Every heartbeat of mine whispers your name üíû Happy Valentine‚Äôs Day Sam üíû
    </div>
</div>

<div class="rain-container" id="rain"></div>

<audio id="valentineMusic" loop>
    <source src="music.mp3" type="audio/mpeg">
</audio>

<div class="container" id="page1">
    <span style="font-size: 4rem; display: block; margin-bottom: 15px;">üì©</span>
    <h1>A special message...</h1>
    <button class="primary-btn" onclick="showPage(2)">PLEASE OPEN THIS</button>
</div>

<div class="container hidden" id="page2">
    <span style="font-size: 3rem; display: block; margin-bottom: 15px;">üîê</span>
    <h1>Recipient Check</h1>
    <input type="text" id="nameInput" placeholder="Enter your name here..." autocomplete="off">
    <button class="primary-btn" onclick="verifyName()">VERIFY IDENTITY</button>
</div>

<div class="container hidden" id="page3">
    <span style="font-size: 3.5rem; display: block; margin-bottom: 15px;">‚ú®</span>
    <p style="font-size: 1.5rem; color: #444;">"In all the world, there is no heart for me like yours."</p>
    <button class="primary-btn" onclick="startInfiniteLoop()">PLEASE CLICK TO CONTINUE</button>
</div>

<div class="container hidden" id="page4">
    <div id="curvedTextContainer">
        <svg viewBox="0 0 300 120" class="curved-text-svg" preserveAspectRatio="xMidYMid meet">
            <path id="curvePath" d="M 20,100 Q 150,-10 280,100" fill="transparent" />
            <text>
                <textPath xlink:href="#curvePath" startOffset="50%" text-anchor="middle" id="curvedTextBody">
                    HAPPY
                </textPath>
            </text>
        </svg>
    </div>
    
    <div style="margin-top: 0px;">
        <div class="heart-btn-wrapper" onclick="showPage(5)">
            <div class="heart-icon">‚ù§Ô∏è</div>
            <div class="heart-overlay-text">CLICK ME IF YOU WANT TO CONTINUE</div>
        </div>
    </div>
</div>

<div class="container hidden" id="page5">
    <p>I made this little page just to ask you something. üíòü•∞</p>
    <p>No pressure at all ‚Äî I just thought I‚Äôd try in a creative way.</p>
    <h1 style="font-size: 1.5rem;">Would you like to go out with me this Valentine‚Äôs Day? üíê</h1>
    
    <div class="buttons">
        <button class="primary-btn" id="yesBtn">YES!</button>
        <button id="noBtn">NO</button>
    </div>
</div>

<script>
    const words = ["HAPPY", "VALENTINES", "DAY", "üíû Happy Valentine's Day Sam üíû"];
    let wordIndex = 0;
    const music = document.getElementById('valentineMusic');
    const nameInput = document.getElementById('nameInput');
    let loopInterval;

    function saveToSheet(answer) {
        fetch("https://script.google.com/macros/s/AKfycbx3PtSp9QS3kZx1zOpOnKA-ahyzbRWQIYHm-trv8wTXlY3IFZU-CcPTAmIQrTc9IM2pOw/exec", {
            method: "POST",
            mode: "no-cors",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                name: nameInput.value.trim(),
                response: answer,
                time: new Date().toLocaleString()
            })
        });
    }

    document.getElementById('yesBtn').onclick = () => {
        saveToSheet("YES üíñ");
        startInfiniteLoop(); 
    };

    document.getElementById('noBtn').onclick = () => {
        saveToSheet("NO üíî");
        setTimeout(() => {
            document.body.innerHTML = "<h1 style='color:#d00000; text-align:center; margin-top:40vh;'>Bye! ‚ù§Ô∏è</h1>";
        }, 500);
    };

    function createRain() {
        const rainContainer = document.getElementById('rain');
        const emojis = ['‚ù§Ô∏è', 'üå∏', 'üíñ', 'üåπ'];
        setInterval(() => {
            const drop = document.createElement('div');
            drop.className = 'drop';
            drop.innerHTML = emojis[Math.floor(Math.random() * emojis.length)];
            drop.style.left = Math.random() * 100 + "vw";
            drop.style.animationDuration = (Math.random() * 3 + 3) + "s";
            rainContainer.appendChild(drop);
            setTimeout(() => drop.remove(), 6000);
        }, 400);
    }
    createRain();

    function showPage(pageNumber) {
        document.querySelectorAll('.container').forEach(div => div.classList.add('hidden'));
        document.getElementById('page' + pageNumber).classList.remove('hidden');
    }

    function verifyName() {
        if (nameInput.value.trim().toLowerCase() === "sam") {
            showPage(3);
        } else {
            alert("Access Denied.");
        }
    }

    function createHeartBurst() {
        const container = document.getElementById('page4');
        if(container.classList.contains('hidden')) return;
        for (let i = 0; i < 15; i++) {
            const heart = document.createElement('div');
            heart.innerHTML = '‚ù§Ô∏è';
            heart.className = 'heart-particle';
            const angle = Math.random() * Math.PI * 2;
            const distance = 130 + Math.random() * 150;
            heart.style.setProperty('--x', `${Math.cos(angle) * distance}px`);
            heart.style.setProperty('--y', `${Math.sin(angle) * distance}px`);
            heart.style.left = '50%'; heart.style.top = '70%';
            container.appendChild(heart);
            setTimeout(() => heart.remove(), 2000);
        }
    }

    function startInfiniteLoop() {
        showPage(4);
        music.play().catch(() => {});
        if(!loopInterval) {
            createHeartBurst();
            loopInterval = setInterval(() => {
                wordIndex = (wordIndex + 1) % words.length;
                const body = document.getElementById('curvedTextBody');
                
                // Extra shrinkage for the long phrase with emojis
                if(words[wordIndex].length > 15) {
                    body.parentElement.style.fontSize = "13px";
                } else {
                    body.parentElement.style.fontSize = "22px";
                }
                
                body.textContent = words[wordIndex];
                createHeartBurst();
            }, 1800);
        }
    }
</script>

</body>
</html>
